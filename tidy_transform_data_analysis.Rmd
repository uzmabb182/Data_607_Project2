---
title: "Data 607-Tidying and Tranformation Data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
library(tidyverse)
library(tidyr)
library(dplyr)

```


```{r}
# Get working directory path
path <- getwd()

path
```

```{r}

setwd("C:/Users/Uzma/CUNY_SPS_PROJECTS/Data_607_Project2")

```


```{r}
library(readr)

dataset1 <- read_csv("C:/Users/Uzma/CUNY_SPS_PROJECTS/Data_607_Project2/census_us_county_data.csv")

```

```{r}
dataset2 <- read_csv("C:/Users/Uzma/CUNY_SPS_PROJECTS/Data_607_Project2/ers_usda_education_data.csv")
```

```{r}
dataset3 <- read_csv("C:/Users/Uzma/CUNY_SPS_PROJECTS/Data_607_Project2/county_fips_data.csv")
```

```{r}
head(dataset1)
```

# Make the column names lowercase

```{r}
names(dataset1) <- tolower(names(dataset1))    # Convert colnames to lower case
dataset1  
```
# Seperating a column into two columns dataset1

```{r}
dataset1 <- dataset1 %>% separate(name, c("county", "state"), ",")

dataset1
```

# Dropping duplicates
```{r}
dataset1 <- dataset1 %>% distinct()

dataset1
```

# Renaming the columns
```{r}
names(dataset1)[4:9] <- c('median_age', 'household_income', 'per_capita_income', 'poverty_count',
                     'poverty_rate', 'unemployment_rate')

dataset1
```

# Removing the string 'county'
```{r}
dataset1$county <-gsub(" County","",as.character(dataset1$county))

dataset1
```

```{r}
glimpse(dataset1)
```

```{r}
str(dataset1)
```

```{r}
dataset1$state <- trimws(dataset1$state, which = c("left"))

str(dataset1)

```

```{r}
# sort by state and county
# sort the dataframe in R using arrange

dataset1 <- arrange(dataset1,state, county)

dataset1
```

# Step 1: Select data frame
# Step 2: Group data
# Step 3: Summarize the data
# Step 4: Plot the summary statistics
```{r}
library(ggplot2)
# Step 1
dataset1 %>% 
#Step 2
group_by(state) 


```
# Multiple columns data by bar plot:
```{r}
# First filter the state Alabama and selecting the columns 

data_alabama <- dataset1 %>% filter(state == "Alabama") %>%

  select(c(3:9, 1))

data_alabama
```
```{r}
str(data_alabama)
```


# Transform the table from wide form to long form
```{r}
data_al <- data_alabama %>%

  pivot_longer(cols = c(2:8),

               names_to = "Variable",

               values_to = "Value")

data_al
```

```{r}
bar_plot <- ggplot(data = data_al, aes(x = Variable, y = Value, fill = Variable)) +

  geom_bar(stat = "identity") + coord_flip() +
  
  labs(
        x = "Variables",
        y = "Values",
        title = paste(
            "Census data for Alabama"
        )
)
bar_plot

```


